# Preset System

**Purpose**: Full 4-component preset system for virtual component styling with LIVE updates

---

## Components to Implement

### 1. Theme Processor Enhancement
**Current**: Basic CSS generation  
**Need to Add**:
- ✅ Read preset categories from theme JSON
- ✅ Generate CSS classes for each preset
- ✅ Support compound selectors (.ui.primary)
- ✅ Support descendant selectors (.ui .sidebar)
- ✅ Handle state selectors (_hover, _active)
- ✅ Process component-specific presets

### 2. PresetStore (New - In ONEstore)
**Current**: Not implemented  
**Already Added to ONEstore**:
- ✅ activePresets: { [assetId]: string[] }
- ✅ globalPresets: { [assetType]: string[] }
- ✅ availablePresets: string[]
- ✅ presetInheritance: { [assetId]: string[] }
- ✅ All preset actions (apply, remove, toggle, etc.)

### 3. PresetManager (New Component)
**Current**: Not implemented  
**Need to Create**:
- ✅ Runtime CSS variable updates
- ✅ Event-based preset changes
- ✅ Conflict resolution between presets
- ✅ Dynamic style injection
- ✅ Preset inheritance calculation
- ✅ Live updates without reload

### 4. ONEconnect Enhancement
**Current**: Basic implementation  
**Need to Add**:
- ✅ Read data-preset-targets from theme
- ✅ Get active presets from store
- ✅ Apply preset classes to wrapper divs
- ✅ Support :wrapper targeting syntax

---

## Implementation Steps

### Phase 1: Theme Processor
```
1. Add processPresets() function
2. Generate proper CSS selectors
3. Support all preset categories
4. Handle state variations
```

### Phase 2: PresetManager Component
```
1. Create new component (150 lines)
2. Connect to PresetStore
3. Implement CSS variable injection
4. Add conflict resolution
```

### Phase 3: ONEconnect Integration
```
1. Add preset reading from theme
2. Connect to PresetStore
3. Apply classes to components
4. Test with virtual divs
```

---

## How It Works Together

1. **Theme defines presets** → Theme Processor generates CSS
2. **Store tracks active presets** → Which presets are ON/OFF
3. **PresetManager applies changes** → Live CSS variable updates
4. **ONEconnect adds classes** → Components get styled

---

## Critical for Virtual Components

Without this system, virtual components (auto-generated divs) cannot be styled! This enables:
- Theme-driven styling
- Live updates
- No React components needed
- Full flexibility

---

*4 components working together for maximum power*