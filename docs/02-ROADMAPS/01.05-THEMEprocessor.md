# Theme Processor

**Current**: 150 lines (ThemeProcessor.ts) + 19 lines (types.ts)  
**Purpose**: Converts JSON theme files to CSS and injects into DOM

---

## IMPLEMENTED Features

### Core Processing

✅ **JSON theme loading**
- Loads from `/data/themes/${themeName}-theme.json`
- Caches loaded themes in Map
- Returns theme config for other systems

✅ **CSS variable generation**
- Converts nested variables to CSS custom properties
- Format: `--category-name: value`
- Supports nested categories (colors.primary → --color-primary)

✅ **Theme scoping**
- Wraps all CSS in `.ui` or `.one` class
- Prevents style bleeding between themes
- Each theme isolated to its scope

✅ **camelCase to kebab-case**
- Converts JavaScript names to CSS
- gridTemplateAreas → grid-template-areas
- backgroundColor → background-color

### Style Processing

✅ **Root structure styles**
- Processes theme.structure.root directly
- Applied to theme scope (`.ui {}`)
- Typically contains grid layout

✅ **Additional structure elements**
- Processes other structure keys as classes
- Creates `.ui .element-name {}` rules
- Currently basic implementation

✅ **DOM injection**
- Creates style elements with unique IDs
- Removes old styles before injecting new
- Styles added to document head

### Theme Structure

✅ **Variables support**
```json
{
  "variables": {
    "colors": { "primary": "#007acc" },
    "spacing": { "small": "0.5rem" }
  }
}
```

✅ **Structure support**
```json
{
  "structure": {
    "root": { "display": "grid" },
    "sidebar": { "width": "250px" }
  }
}
```

---

## POTENTIAL Features to Evaluate

*Note: These come from OOPS implementations. Critical ones marked.*

❌ **Preset system** - **CRITICAL for virtual components**
- Component presets (layertree-wrapper styles)
- Look presets (primary, secondary themes)  
- Layout presets (dashboard, canvas layouts)
- State support (_hover, _active)
- Would enable virtual component styling

❌ **Import system**
- Load base themes that others extend
- Merge variables and presets
- Reduce duplication across themes
- OOPS had this for modularity

❌ **Component-specific selectors**
- Generate `.ui.dashboard` for layouts
- Generate `.ui .layertree-wrapper` for components
- More specific than current implementation
- Needed for preset targeting

❌ **Pseudo element support**
- ::before, ::after content
- Decorative elements from theme
- OOPS used for icons/badges

❌ **State-based styles**
- [data-state="active"] selectors
- Dynamic component states
- More flexible than :hover/:active

❌ **Media queries**
- Responsive breakpoints in theme
- Mobile/tablet/desktop variants
- Not in current implementation

❌ **CSS minification**
- Reduce injected CSS size
- Strip comments and whitespace
- Performance optimization

❌ **Hot reload**
- Reload themes without refresh
- Development convenience
- Nice to have, not critical

---

## Technical Terms

- **Theme scope**: CSS class (`.ui` or `.one`) that wraps all theme styles
- **CSS variables**: Custom properties like `--color-primary` that can be reused
- **kebab-case**: CSS naming convention using dashes (background-color)
- **DOM injection**: Adding `<style>` elements to the page programmatically
- **Presets**: Pre-defined style combinations that can be applied to components

---

## Connection Status

**Currently Working:**
- ✅ App.tsx loads 'ui' theme successfully
- ✅ CSS variables available to all components
- ✅ Grid layouts from theme structure

**NOT Implemented Yet:**
- ❌ Preset system (needed for virtual components)
- ❌ Component-specific styling beyond root
- ❌ Dynamic theme switching
- ❌ Theme inheritance/imports

**Critical for uiONE virtual components:**
1. **Preset system is essential** - without it, no styling for virtual divs
2. Need component-specific selectors
3. Consider state-based styles for interactions
4. Import system would help with theme variations

---

*Transforms JSON themes into living CSS*