# ONEconnect

**Current**: 115 lines (ONEconnect.tsx) + 91 lines (storeConnector.ts)  
**Purpose**: Component orchestration - renders theme-driven UI with store connections

---

## IMPLEMENTED Features

### Core Rendering

✅ **Theme-driven rendering**
- Reads layout from theme.structure.root.layouts
- Renders components based on theme.structure definitions
- Currently hardcoded to look in specific location (NOT flexible yet)

✅ **Auto component registration** 
- Falls back to 'div' if component not found (line 58)
- Perfect for virtual components - no React component needed!
- Creates div with all data attributes preserved

✅ **Grid area auto-assignment**
- Built-in getGridArea() function (a-z, then aa, ab, etc.)
- Each component wrapper gets automatic grid area
- Can be overridden by theme grid-area property

✅ **Component ID generation**
- generateComponentId() creates unique IDs
- Format: `${type}-${timestamp}-${counter}`
- Used when theme doesn't provide ID

### Component Wrapping

✅ **Wrapper div system**
- Each component wrapped in div with grid area
- Classes: `one-wrapper ${componentType}-wrapper`
- data-component and data-id attributes added

✅ **Props spreading**
- Theme props passed via {...componentDef.props}
- Store data passed via {...data}
- Store actions passed via {...actions}

### Store Connection (Basic)

✅ **StoreConnector class**
- getValue(storeName, path) - gets data from store
- getAction(storeName, actionName) - gets action methods
- Currently only supports one-level paths (NOT nested)

✅ **data-source binding**
- Format: "storeName.property" (e.g. "oneStore.selectedElement")
- Value extracted and passed as prop
- Only supports single data source per component (NOT multiple)

✅ **data-actions binding**
- Maps events to store actions
- Example: { onClick: "oneStore.selectElement" }
- Action functions passed as props

---

## POTENTIAL Features to Evaluate

*Note: These come from OOPS implementations. Evaluate before adding.*

❌ **Path-based subscriptions** (from OOPS)
- Deep path support like "oneStore.designer.selectedElement"
- Multiple subscriptions per component
- Automatic re-render on data change
- Would improve our basic store connection

❌ **Recursive component loading**
- Components can have children components
- Nested theme structures
- Currently only renders top-level components

❌ **Layout switching from store**
- Read layout from uiStore instead of theme.root
- Dynamic layout changes without theme reload
- Needed for layout switcher component

❌ **Preset targeting system**
- data-preset-targets on components
- Apply presets as CSS classes
- Enable theme-driven styling
- **Critical for virtual components**

❌ **Data transformation**
- Transform data before passing to components
- Derived data sources
- Static data sources
- More flexible than current direct mapping

❌ **Component caching**
- Cache component instances
- Improve performance for complex UIs
- OOPS had this for optimization

❌ **Auth gating**
- data-auth: 'required' on components
- Skip rendering if not authenticated
- Useful for protected UI sections

❌ **Cloud sync attributes**
- data-cloud-sync settings
- Component-level sync configuration
- May not need this complexity

---

## Technical Terms

- **Auto-registration**: If a component isn't found in the components map, ONEconnect creates a div instead
- **Grid area**: CSS Grid positioning - each component gets a letter (a, b, c... z, aa, ab...)
- **Theme structure**: JSON defining which components to render and their configuration
- **Store connector**: Bridge between Zustand stores and React components
- **Data binding**: Connecting store data/actions to component props

---

## Connection Status

**Currently Connected:**
- ✅ Theme JSON is read and components rendered
- ✅ Basic store data/actions work

**NOT Connected Yet:**
- ❌ ONEstore currentView (for dynamic layouts)
- ❌ Preset system (for virtual component styling)
- ❌ Deep store paths (only one level works)
- ❌ Multiple data sources per component

**Critical for uiONE virtual components:**
1. Auto-registration already works! (creates divs)
2. Need preset system for styling
3. Need flexible layout reading (not hardcoded path)
4. Consider path-based subscriptions for complex data

---

*Central orchestrator - connects themes, stores, and components*